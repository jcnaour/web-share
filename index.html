<!DOCTYPE html>
<html>
  <head>
    <title>Web Share Testing</title>

  </head>
  <body>

    <h3>Share</h3>
    <button id="test-web-share">
      Share
    </button>

    <script>
      
      function directShare() {
        navigator.share({
          title: 'My awesome post!',
          text: 'This post may or may not contain the answer to the universe',
          url: window.location.href
        }).then(() => {
          //window.alert('Thanks for sharing!');
        })
        .catch(err => {
          //window.alert(`Couldn't share because of`, err);
        });
      }
      
      function webShare() {
        if (navigator.share) {
          if (window.fetchEnabled) {
            let myRequest = new Request('https://mkonikov.com/images/instants.jpg');
            fetch(myRequest)
            .then(function(response) {
              if (!response.ok) {
                throw new Error('HTTP error, status = ' + response.status);
              }
              return response.blob();
            })
            .then(function(response) {
              directShare();
            })
          }
          else {
            directShare();
          }
        } else {
          //window.alert('web share not supported');
        }
      }
      document.querySelector('#test-web-share').addEventListener('click', () => {
        webShare()
      });
      
        function codeAddress() {
          alert("auto");
            webShare();
        }
        window.onload = codeAddress;
    </script>
  </body>
</html>
